const mainDiv=document.getElementById("main"),colors=["#31afcb","#7f55c9","#758cef","#218a8a"],labels=["CPU Usage","Memory Usage","Disk Usage"];async function checkOnlineStatus(t,s){let e=t;"localhost"!==t&&(e=`http://${e}`);const a=new AbortController,i=setTimeout((()=>a.abort()),5e3),n=await fetch(e,{method:"HEAD",signal:a.signal}).then((()=>!0)).catch((()=>!1));clearTimeout(i),s.style.backgroundColor=n?"#07cb07":"#d20707"}async function main(){const t=await fetch("/available-devices").catch(),s=await t.json();let e={};Object.entries(s).forEach((function([t,s],a){const i=`lineChart${a}`,n=[`progress${a}0`,`progress${a}1`,`progress${a}2`],r=[`temp${a}0`],o=`onlineStatus${a}`;e[s]={},e[s].onlineStatusId=o,e[s].lineChartId=i,e[s].progressChartIds=n,e[s].tempChartsIds=r,mainDiv.innerHTML+=`<details>\n        <summary>\n            <img alt="Computer" class="icon" height="55px" src="assets/imgs/computer.svg" style="padding: 10px">\n            <div id="${o}" style="width: 20px; height: 20px; background-color: grey; margin: 10px; border-radius: 20px"></div>\n            ${t}\n            <span style="margin-left: auto; margin-right: 10px">${s}</span>\n        </summary>\n\n        <div class="col">\n            <div class="box mt-4">\n                <div class="mt-4">\n                    <div id="${r[0]}"></div>\n                </div>\n            </div>\n            <div class="box mt-4">\n                <div class="mt-4">\n                    <div id="${n[0]}"></div>\n                </div>\n                <div class="mt-4">\n                    <div id="${n[1]}"></div>\n                </div>\n                <div class="mt-4">\n                    <div id="${n[2]}"></div>\n                </div>\n            </div>\n            <div class="box mt-4">\n                <div id="${i}"></div>\n            </div>\n        </div>\n      </details>`}));for(const t of Object.keys(e))e[t].lineChart=createLineChart(e[t].lineChartId),e[t].progressCharts=createProgressCharts(e[t].progressChartIds,labels,colors),e[t].tempCharts=createProgressCharts(e[t].tempChartsIds,["CPU Temperature"],[colors[1]]),e[t].onlineStatus=document.getElementById(e[t].onlineStatusId);for(const t of Object.keys(e))await updateCharts(t,e[t].progressCharts,e[t].tempCharts,e[t].lineChart);window.setInterval((function(){for(const t of Object.keys(e))updateCharts(t,e[t].progressCharts,e[t].tempCharts,e[t].lineChart),checkOnlineStatus(t,e[t].onlineStatus)}),5e3)}window.Apex={chart:{foreColor:"#fff",toolbar:{show:!1}},colors:colors,stroke:{width:3},dataLabels:{enabled:!1},grid:{borderColor:"#40475D"},xaxis:{axisTicks:{color:"#333"},axisBorder:{color:"#333"}},fill:{type:"full"},tooltip:{theme:"dark"},yaxis:{decimalsInFloat:1,opposite:!0,labels:{offsetX:-10}}},main();
